<!DOCTYPE appendix>
<appendix xmlns="http://docbook.org/ns/docbook" version="5.0" xml:id="montables" xml:lang="ru">
    <info>
        <title>Описания таблиц мониторинга</title>
    </info>

    <para> СУБД Firebird предоставляет возможность отслеживать работу с конкретной базой данных,
        выполняемую на стороне сервера. Для этих целей используются таблицы мониторинга (имеют
        префикс имени MON$). Эти таблицы являются виртуальными в том смысле, что до обращения к ним
        со стороны пользователя, никаких данных в них не записано. Они заполняются данными только в
        момент запроса пользователя (в том числе, поэтому на такие таблицы бесполезно пытаться
        создавать триггеры). При этом описания этих таблиц в базе данных присутствуют
        постоянно.</para>
    <para>Ключевым понятием функции мониторинга является снимок активности. Снимок представляет
        собой текущее состояние базы данных, содержащее множество информации о самой базе данных,
        активных соединениях, пользователях, транзакциях, подготовленных и выполняемых запросах и
        т.д.</para>
    <para>Снимок создаётся при первой выборке из любой таблицы мониторинга и сохраняется до конца
        текущей транзакции, чтобы запросы к множеству таблиц (например, главная-подчинённая) всегда
        возвращал непротиворечивые данные.</para>
    <para>Другими словами таблицы мониторинга ведут себя подобно snapshot table stability
        (&quot;consistency&quot;) транзакции, даже если родительская транзакция была запущена с
        меньшим уровнем изоляции.</para>
    <para>Для обновления снимка, текущая транзакция должна быть завершена и таблицы мониторинга
        должны быть запрошены в новом контексте транзакции.</para>
    <para>
        <itemizedlist spacing="compact">
            <title>Безопасность:</title>
            <listitem>
                <para>Полный доступ ко всей информации, предоставляемой таблицами мониторинга, имеют
                    SYSDBA и владелец базы данных;</para>
            </listitem>
            <listitem>
                <para>Обычные пользователи ограничены информацией о собственных соединениях, другие
                    соединения невидимы для них.</para>
            </listitem>
        </itemizedlist>
    </para>
    <note>
        <para>Частый сбор информации с помощью таблиц мониторинга в сильно нагруженной среде может
            негативно отразится на производительности системы.</para>
    </note>
    <para>
        <table xml:id="montables-tbl-montables" frame="all">
            <?dbfo keep-together='auto'?>
            <title>Таблицы мониторинга</title>
            <tgroup cols="2">
                <colspec colname="colTable" colnum="1" colwidth="2*" align="left"/>
                <colspec colname="colDesc" colnum="2" colwidth="3*" align="left"/>
                <thead>
                    <row valign="middle">
                        <entry align="center">Таблица</entry>
                        <entry align="center">Содержание</entry>
                    </row>
                </thead>
                <tbody>
                    <row valign="middle">
                        <entry><link linkend="montables-attachments">MON$ATTACHMENTS</link></entry>
                        <entry>Сведения о текущих соединениях с базой данных.</entry>
                    </row>
                    <row valign="middle">
                        <entry><link linkend="montables-call_stack">MON$CALL_STACK</link></entry>
                        <entry>Обращения к стеку активными запросами хранимых процедур и
                            триггеров.</entry>
                    </row>
                    <row valign="middle">
                        <entry><link linkend="montables-context_variables"
                                >MON$CONTEXT_VARIABLES</link></entry>
                        <entry>Сведения о пользовательских контекстных переменных.</entry>
                    </row>
                    <row valign="middle">
                        <entry><link linkend="montables-database">MON$DATABASE</link></entry>
                        <entry>Сведения о базе данных, с которой выполнено соединение.</entry>
                    </row>
                    <row valign="middle">
                        <entry><link linkend="montables-io_stats">MON$IO_STATS</link></entry>
                        <entry>Статистика по вводу-выводу.</entry>
                    </row>
                    <row valign="middle">
                        <entry><link linkend="montables-memory_usage"
                            >MON$MEMORY_USAGE</link></entry>
                        <entry>Статистика использования памяти.</entry>
                    </row>
                    <row valign="middle">
                        <entry><link linkend="montables-record_stats"
                            >MON$RECORD_STATS</link></entry>
                        <entry>Статистика на уровне записей.</entry>
                    </row>
                    <row valign="middle">
                        <entry><link linkend="montables-statements">MON$STATEMENTS</link></entry>
                        <entry>Подготовленные к выполнению операторы.</entry>
                    </row>
                    <row valign="middle">
                        <entry><link linkend="montables-table_stats">MON$TABLE_STATS</link></entry>
                        <entry>Статистика на уровне таблиц.</entry>
                    </row>
                    <row valign="middle">
                        <entry><link linkend="montables-transactions"
                            >MON$TRANSACTIONS</link></entry>
                        <entry>Запущенные транзакции.</entry>
                    </row>
                </tbody>
            </tgroup>
        </table>
    </para>
    <section xml:id="montables-attachments">
        <info>
            <title>MON$ATTACHMENTS</title>
            <keywordset>
                <keyword>MON$ATTACHMENTS</keyword>
            </keywordset>
        </info>
        <indexterm><primary>MON$ATTACHMENTS</primary></indexterm>
        <para>Сведения о текущих соединениях с базой данных.</para>
        <para>
            <table xml:id="montables-tbl-attachments" frame="all">
                <?dbfo keep-together='auto'?>
                <title>Описание столбцов таблицы MON$ATTACHMENTS</title>
                <tgroup cols="3">
                    <colspec colname="colColumn" colnum="1" colwidth="4*" align="left"/>
                    <colspec colname="colType" colnum="2" colwidth="3*" align="left"/>
                    <colspec colname="colDesc" colnum="3" colwidth="5*" align="left"/>
                    <thead>
                        <row valign="middle">
                            <entry align="center">Наименование столбца</entry>
                            <entry align="center">Тип данных</entry>
                            <entry align="center">Описание</entry>
                        </row>
                    </thead>
                    <tbody>
                        <row>
                            <entry>MON$ATTACHMENT_ID </entry>
                            <entry>BIGINT </entry>
                            <entry>Идентификатор соединения. </entry>
                        </row>
                        <row>
                            <entry>MON$SERVER_PID </entry>
                            <entry>INTEGER </entry>
                            <entry>Идентификатор серверного процесса. </entry>
                        </row>
                        <row>
                            <entry>MON$STATE </entry>
                            <entry>SMALLINT </entry>
                            <entry>
                                <para>Состояние соединения: <itemizedlist spacing="compact">
                                        <listitem>
                                            <para>0 — бездействующее;</para>
                                        </listitem>
                                        <listitem>
                                            <para>1 — активное.</para>
                                        </listitem>
                                    </itemizedlist>
                                </para>
                            </entry>
                        </row>
                        <row>
                            <entry>MON$ATTACHMENT_NAME </entry>
                            <entry>VARCHAR(255) </entry>
                            <entry>Строка соединения — полный путь к файлу и имя первичного файла
                                базы данных. </entry>
                        </row>
                        <row>
                            <entry>MON$USER </entry>
                            <entry>CHAR(63) </entry>
                            <entry>Имя пользователя, соединённого с базой данных. </entry>
                        </row>
                        <row>
                            <entry>MON$ROLE </entry>
                            <entry>CHAR(63) </entry>
                            <entry>Имя роли, указанное при соединении. Если роль во время соединения
                                не была задана, поле содержит текст NONE. </entry>
                        </row>
                        <row>
                            <entry>MON$REMOTE_PROTOCOL </entry>
                            <entry>VARCHAR(10) </entry>
                            <entry>Имя удалённого протокола. </entry>
                        </row>
                        <row>
                            <entry>MON$REMOTE_ADDRESS </entry>
                            <entry>VARCHAR(255) </entry>
                            <entry>Удалённый адрес (адрес и имя сервера). </entry>
                        </row>
                        <row>
                            <entry>MON$REMOTE_PID </entry>
                            <entry>INTEGER </entry>
                            <entry>Идентификатор удалённого клиентского процесса. </entry>
                        </row>
                        <row>
                            <entry>MON$CHARACTER_SET_ID </entry>
                            <entry>SMALLINT </entry>
                            <entry>Идентификатор набора символов в соединении. </entry>
                        </row>
                        <row>
                            <entry>MON$TIMESTAMP </entry>
                            <entry>TIMESTAMP </entry>
                            <entry>Дата и время начала соединения. </entry>
                        </row>
                        <row>
                            <entry>MON$GARBAGE_COLLECTION </entry>
                            <entry>SMALLINT </entry>
                            <entry>Флаг сборки мусора (указывается в DPB при подключении):
                                1-позволяется, 0 - не позволяется. </entry>
                        </row>
                        <row>
                            <entry>MON$REMOTE_PROCESS </entry>
                            <entry>VARCHAR(255) </entry>
                            <entry>Полный путь к файлу и имя программного файла, выполнившего данное
                                соединение. </entry>
                        </row>
                        <row>
                            <entry>MON$STAT_ID </entry>
                            <entry>INTEGER </entry>
                            <entry>Идентификатор статистики. </entry>
                        </row>
                        <row>
                            <entry>MON$CLIENT_VERSION </entry>
                            <entry>VARCHAR(255)</entry>
                            <entry>Версия клиентской библиотеки.</entry>
                        </row>
                        <row>
                            <entry>MON$REMOTE_VERSION </entry>
                            <entry>VARCHAR(255)</entry>
                            <entry>Версия удалённого протокола.</entry>
                        </row>
                        <row>
                            <entry>MON$REMOTE_HOST </entry>
                            <entry>VARCHAR(255)</entry>
                            <entry>Имя удалённого хоста.</entry>
                        </row>
                        <row>
                            <entry>MON$REMOTE_OS_USER </entry>
                            <entry>VARCHAR(255)</entry>
                            <entry>Имя пользователя в операционной системе.</entry>
                        </row>
                        <row>
                            <entry>MON$AUTH_METHOD </entry>
                            <entry>VARCHAR(255)</entry>
                            <entry>Метод проверки подлинности, используемый при подключении.</entry>
                        </row>
                        <row>
                            <entry>MON$SYSTEM_FLAG </entry>
                            <entry>SMALLINT</entry>
                            <entry>
                                <para>Флаг того, что подключение системное: <itemizedlist
                                        spacing="compact">
                                        <listitem>
                                            <para>0 — пользовательское подключение;</para>
                                        </listitem>
                                        <listitem>
                                            <para>1 — системное подключение.</para>
                                        </listitem>
                                    </itemizedlist></para>
                            </entry>
                        </row>
                        <row>
                            <entry>MON$IDLE_TIMEOUT</entry>
                            <entry>INTEGER</entry>
                            <entry>Тайм-аут простоя соединения уровня соединения. Содержит значение
                                тайм-аута простоя уровня соединения, в секундах. Если тайм-аут не
                                установлен — 0.</entry>
                        </row>
                        <row>
                            <entry>MON$IDLE_TIMER</entry>
                            <entry>TIMESTAMP</entry>
                            <entry>Время истечения таймера ожидания. Содержит NULL, если тайм-аут
                                простоя соединения не установлен, или если таймер не
                                запущен.</entry>
                        </row>
                        <row>
                            <entry>MON$STATEMENT_TIMEOUT</entry>
                            <entry>INTEGER</entry>
                            <entry>Тайм-аут SQL оператора уровня соединения. Содержит значение
                                тайм-аута, установленное на уровне соединения, в миллисекундах. Если
                                тайм-аут не установлен — 0.</entry>
                        </row>
                        <row>
                            <entry>MON$WIRE_COMPRESSED</entry>
                            <entry>BOOLEAN</entry>
                            <entry>Используется ли сжатие сетевого трафика. Если используется сжатие
                                сетевого трафика значение равно TRUE, если не используется — FALSE.
                                Для встроенных соединений — возвращает NULL.</entry>
                        </row>
                        <row>
                            <entry>MON$WIRE_ENCRYPTED</entry>
                            <entry>BOOLEAN</entry>
                            <entry>Используется ли шифрование сетевого трафика. Если используется
                                шифрование сетевого трафика значение равно TRUE, если не
                                используется — FALSE. Для встроенных соединений — возвращает
                                NULL.</entry>
                        </row>
                    </tbody>
                </tgroup>
            </table>
        </para>

        <formalpara>
            <title>Примеры:</title>
            <para>
                <example>
                    <title>Получение сведений о клиентских приложениях</title>
                    <para><programlisting language="sql">
SELECT MON$USER, MON$REMOTE_ADDRESS, MON$REMOTE_PID, MON$TIMESTAMP
FROM MON$ATTACHMENTS
WHERE MON$ATTACHMENT_ID &lt;&gt; CURRENT_CONNECTION               
                </programlisting></para>
                </example>
            </para>
        </formalpara>

        <section xml:id="montables-attachments-delete">
            <title>Использование MON$ATTACHMENTS для закрытия подключений</title>

            <para>Таблицы мониторинга доступны только для чтения. Однако в сервер встроен механизм
                для удаления (и только удаления) записей в таблице MON$ATTACHMENTS, что позволяет,
                закрыть соединение с базой данных.</para>
            <note>
                <para>
                    <itemizedlist spacing="compact">
                        <listitem>
                            <para>Вся текущая активность в удаляемом соединении немедленно
                                прекращается, и все активные транзакции откатываются;</para>
                        </listitem>
                        <listitem>
                            <para>Закрытое соединение вернёт приложению ошибку с кодом
                                isc_att_shutdown;</para>
                        </listitem>
                        <listitem>
                            <para>Последующие попытки использовать это соединение (т.е. использовать
                                его handle в API-вызовах) вернут ошибки;</para>
                        </listitem>
                        <listitem>
                            <para>Завершение системных соединений (MON$SYSTEM_FLAG = 1) невозможно.
                                Сервер пропустит системные подключения затронутые оператором DELETE
                                FROM MON$ATTACHMENTS.</para>
                        </listitem>
                    </itemizedlist>
                </para>
            </note>

            <formalpara>
                <title>Примеры:</title>
                <para>
                    <example>
                        <title>Отключение всех соединений, за исключением своего</title>
                        <para><programlisting language="sql">
DELETE FROM MON$ATTACHMENTS
WHERE MON$ATTACHMENT_ID &lt;&gt; CURRENT_CONNECTION               
                </programlisting></para>
                    </example>
                </para>
            </formalpara>
        </section>
    </section>
    <section xml:id="montables-call_stack">
        <info>
            <title>MON$CALL_STACK</title>
            <keywordset>
                <keyword>MON$CALL_STACK</keyword>
            </keywordset>
        </info>
        <indexterm><primary>MON$CALL_STACK</primary></indexterm>
        <para>Обращения к стеку запросами хранимых процедур, хранимых функций и триггеров.</para>
        <para>
            <table xml:id="montables-tbl-call_stack" frame="all">
                <?dbfo keep-together='auto'?>
                <title>Описание столбцов таблицы MON$CALL_STACK</title>
                <tgroup cols="3">
                    <colspec colname="colColumn" colnum="1" colwidth="4*" align="left"/>
                    <colspec colname="colType" colnum="2" colwidth="3*" align="left"/>
                    <colspec colname="colDesc" colnum="3" colwidth="5*" align="left"/>
                    <thead>
                        <row valign="middle">
                            <entry align="center">Наименование столбца</entry>
                            <entry align="center">Тип данных</entry>
                            <entry align="center">Описание</entry>
                        </row>
                    </thead>
                    <tbody>
                        <row>
                            <entry>MON$CALL_ID </entry>
                            <entry>BIGINT </entry>
                            <entry>Идентификатор обращения. </entry>
                        </row>
                        <row>
                            <entry>MON$STATEMENT_ID </entry>
                            <entry>BIGINT </entry>
                            <entry>Идентификатор верхнего уровня оператора SQL — оператора,
                                инициировавшего цепочку обращений. По этому идентификатору можно
                                найти запись об активном операторе в таблице MON$STATEMENTS.
                            </entry>
                        </row>
                        <row>
                            <entry>MON$CALLER_ID </entry>
                            <entry>BIGINT </entry>
                            <entry>Идентификатор обращающегося триггера, хранимой функции или
                                хранимой процедуры. </entry>
                        </row>
                        <row>
                            <entry>MON$OBJECT_NAME </entry>
                            <entry>CHAR(63) </entry>
                            <entry>Имя объекта PSQL. </entry>
                        </row>
                        <row>
                            <entry>MON$OBJECT_TYPE </entry>
                            <entry>SMALLINT </entry>
                            <entry>
                                <para>Тип объекта PSQL: <itemizedlist spacing="compact">
                                        <listitem>
                                            <para>2 — триггер;</para>
                                        </listitem>
                                        <listitem>
                                            <para>5 — хранимая процедура;</para>
                                        </listitem>
                                        <listitem>
                                            <para>15 — хранимая функция.</para>
                                        </listitem>
                                    </itemizedlist>
                                </para>
                            </entry>
                        </row>
                        <row>
                            <entry>MON$TIMESTAMP </entry>
                            <entry>TIMESTAMP </entry>
                            <entry>Дата и время старта обращения. </entry>
                        </row>
                        <row>
                            <entry>MON$SOURCE_LINE </entry>
                            <entry>INTEGER </entry>
                            <entry>Номер исходной строки оператора SQL, выполняющегося в настоящий
                                момент. </entry>
                        </row>
                        <row>
                            <entry>MON$SOURCE_COLUMN </entry>
                            <entry>INTEGER </entry>
                            <entry>Номер исходного столбца оператора SQL, выполняющегося в настоящий
                                момент. </entry>
                        </row>
                        <row>
                            <entry>MON$STAT_ID </entry>
                            <entry>INTEGER </entry>
                            <entry>Идентификатор статистики. </entry>
                        </row>
                        <row>
                            <entry>MON$PACKAGE_NAME</entry>
                            <entry>CHAR(63) </entry>
                            <entry>Имя пакета для упакованных процедур/функций.</entry>
                        </row>
                    </tbody>
                </tgroup>
            </table>
        </para>
        <note>
            <para>В стек вызовов не попадёт информация о вызовах при выполнении оператора EXECUTE
                STATEMENT. </para>
        </note>

        <formalpara>
            <title>Примеры:</title>
            <para>
                <example>
                    <title>Получение стека вызовов для всех подключений кроме своего</title>
                    <para><programlisting language="sql">
WITH RECURSIVE
  HEAD AS (
    SELECT 
      CALL.MON$STATEMENT_ID, CALL.MON$CALL_ID, 
      CALL.MON$OBJECT_NAME, CALL.MON$OBJECT_TYPE
    FROM MON$CALL_STACK CALL
    WHERE CALL.MON$CALLER_ID IS NULL
    UNION ALL
    SELECT 
      CALL.MON$STATEMENT_ID, CALL.MON$CALL_ID, 
      CALL.MON$OBJECT_NAME, CALL.MON$OBJECT_TYPE
    FROM MON$CALL_STACK CALL
      JOIN HEAD ON CALL.MON$CALLER_ID = HEAD.MON$CALL_ID
  )
SELECT MON$ATTACHMENT_ID, MON$OBJECT_NAME, MON$OBJECT_TYPE
FROM HEAD
  JOIN MON$STATEMENTS STMT ON STMT.MON$STATEMENT_ID = HEAD.MON$STATEMENT_ID
WHERE STMT.MON$ATTACHMENT_ID &lt;&gt; CURRENT_CONNECTION               
                </programlisting></para>
                </example>
            </para>
        </formalpara>
    </section>
    <section xml:id="montables-context_variables">
        <info>
            <title>MON$CONTEXT_VARIABLES</title>
            <keywordset>
                <keyword>MON$CONTEXT_VARIABLES</keyword>
            </keywordset>
        </info>
        <indexterm><primary>MON$CONTEXT_VARIABLES</primary></indexterm>
        <para>Сведения о пользовательских контекстных переменных.</para>
        <para>
            <table xml:id="montables-tbl-context_variables" frame="all">
                <?dbfo keep-together='auto'?>
                <title>Описание столбцов таблицы MON$CONTEXT_VARIABLES</title>
                <tgroup cols="3">
                    <colspec colname="colColumn" colnum="1" colwidth="4*" align="left"/>
                    <colspec colname="colType" colnum="2" colwidth="3*" align="left"/>
                    <colspec colname="colDesc" colnum="3" colwidth="5*" align="left"/>
                    <thead>
                        <row valign="middle">
                            <entry align="center">Наименование столбца</entry>
                            <entry align="center">Тип данных</entry>
                            <entry align="center">Описание</entry>
                        </row>
                    </thead>
                    <tbody>
                        <row>
                            <entry>MON$ATTACHMENT_ID </entry>
                            <entry>BIGINT </entry>
                            <entry>Идентификатор соединения. Содержит корректное значение только для
                                контекстных переменных уровня соединения, для переменных уровня
                                транзакции устанавливается в NULL. </entry>
                        </row>
                        <row>
                            <entry>MON$TRANSACTION_ID </entry>
                            <entry>BIGINT</entry>
                            <entry>Идентификатор транзакции. Содержит корректное значение только для
                                контекстных переменных уровня транзакции, для переменных уровня
                                соединения устанавливается в NULL. </entry>
                        </row>
                        <row>
                            <entry>MON$VARIABLE_NAME </entry>
                            <entry>VARCHAR(80) </entry>
                            <entry>Имя контекстной переменной. </entry>
                        </row>
                        <row>
                            <entry>MON$VARIABLE_VALUE </entry>
                            <entry>VARCHAR(32765) </entry>
                            <entry>Значение контекстной переменной. </entry>
                        </row>
                    </tbody>
                </tgroup>
            </table>
        </para>

        <formalpara>
            <title>Примеры:</title>
            <para>
                <example>
                    <title>Получение всех сессионных контекстных переменных для текущего
                        подключения</title>
                    <para><programlisting language="sql">
SELECT VAR.MON$VARIABLE_NAME, VAR.MON$VARIABLE_VALUE
FROM MON$CONTEXT_VARIABLES VAR
WHERE VAR.MON$ATTACHMENT_ID = CURRENT_CONNECTION              
                </programlisting></para>
                </example>
            </para>
        </formalpara>
    </section>
    <section xml:id="montables-database">
        <info>
            <title>MON$DATABASE</title>
            <keywordset>
                <keyword>MON$DATABASE</keyword>
            </keywordset>
        </info>
        <indexterm><primary>MON$DATABASE</primary></indexterm>
        <para>Сведения о базе данных, с которой выполнено соединение.</para>
        <para>
            <table xml:id="montables-tbl-database" frame="all">
                <?dbfo keep-together='auto'?>
                <title>Описание столбцов таблицы MON$DATABASE</title>
                <tgroup cols="3">
                    <colspec colname="colColumn" colnum="1" colwidth="4*" align="left"/>
                    <colspec colname="colType" colnum="2" colwidth="3*" align="left"/>
                    <colspec colname="colDesc" colnum="3" colwidth="5*" align="left"/>
                    <thead>
                        <row valign="middle">
                            <entry align="center">Наименование столбца</entry>
                            <entry align="center">Тип данных</entry>
                            <entry align="center">Описание</entry>
                        </row>
                    </thead>
                    <tbody>
                        <row>
                            <entry>MON$DATABASE_NAME </entry>
                            <entry>VARCHAR(255) </entry>
                            <entry>Полный путь и имя первичного файла базы данных или псевдоним базы
                                данных. </entry>
                        </row>
                        <row>
                            <entry>MON$PAGE_SIZE </entry>
                            <entry>SMALLINT </entry>
                            <entry>Размер страницы файлов базы данных в байтах. </entry>
                        </row>
                        <row>
                            <entry>MON$ODS_MAJOR </entry>
                            <entry>SMALLINT </entry>
                            <entry>Старшая версия ODS. </entry>
                        </row>
                        <row>
                            <entry>MON$ODS_MINOR </entry>
                            <entry>SMALLINT </entry>
                            <entry>Младшая версия ODS. </entry>
                        </row>
                        <row>
                            <entry>MON$OLDEST_TRANSACTION </entry>
                            <entry>BIGINT </entry>
                            <entry>Номер старейшей заинтересованной транзакции — OIT, Oldest
                                Interesting Transaction. </entry>
                        </row>
                        <row>
                            <entry>MON$OLDEST_ACTIVE </entry>
                            <entry>BIGINT </entry>
                            <entry>Номер старейшей активной транзакции — OAT, Oldest Active
                                Transaction. </entry>
                        </row>
                        <row>
                            <entry>MON$OLDEST_SNAPSHOT </entry>
                            <entry>BIGINT </entry>
                            <entry>Номер транзакции, которая была активной на момент старта
                                транзакции OAT, транзакция OST — Oldest Snapshot Transaction.
                            </entry>
                        </row>
                        <row>
                            <entry>MON$NEXT_TRANSACTION </entry>
                            <entry>BIGINT </entry>
                            <entry>Номер следующей транзакции. </entry>
                        </row>
                        <row>
                            <entry>MON$PAGE_BUFFERS </entry>
                            <entry>INTEGER </entry>
                            <entry>Количество страниц, выделенных в оперативной памяти для кэша.
                            </entry>
                        </row>
                        <row>
                            <entry>MON$SQL_DIALECT </entry>
                            <entry>SMALLINT </entry>
                            <entry>SQL диалект базы данных: 1 или 3. </entry>
                        </row>
                        <row>
                            <entry>MON$SHUTDOWN_MODE </entry>
                            <entry>SMALLINT </entry>
                            <entry>
                                <para>Текущее состояние останова (shutdown) базы данных:
                                        <itemizedlist spacing="compact">
                                        <listitem>
                                            <para>0 — база данных активна (online);</para>
                                        </listitem>
                                        <listitem>
                                            <para>1 — останов для нескольких пользователей
                                                (multi-user shutdown);</para>
                                        </listitem>
                                        <listitem>
                                            <para>2 — останов для одного пользователя (single-user
                                                shutdown);</para>
                                        </listitem>
                                        <listitem>
                                            <para>3 — полный останов (full shutdown).</para>
                                        </listitem>
                                    </itemizedlist>
                                </para>
                            </entry>
                        </row>
                        <row>
                            <entry>MON$SWEEP_INTERVAL </entry>
                            <entry>INTEGER </entry>
                            <entry>Интервал чистки (sweep interval).</entry>
                        </row>
                        <row>
                            <entry>MON$READ_ONLY </entry>
                            <entry>SMALLINT </entry>
                            <entry>Признак, является база данных только для чтения, read only,
                                (значение 1) или для чтения и записи, read-write (0).</entry>
                        </row>
                        <row>
                            <entry>MON$FORCED_WRITES </entry>
                            <entry>SMALLINT </entry>
                            <entry>Указывает, установлен ли для базы режим синхронного вывода
                                (forced writes, значение 1) или режим асинхронного вывода (значение
                                0).</entry>
                        </row>
                        <row>
                            <entry>MON$RESERVE_SPACE </entry>
                            <entry>SMALLINT </entry>
                            <entry>Флаг, указывающий на резервирование пространства.</entry>
                        </row>
                        <row>
                            <entry>MON$CREATION_DATE </entry>
                            <entry>TIMESTAMP </entry>
                            <entry>Дата и время создания базы данных.</entry>
                        </row>
                        <row>
                            <entry>MON$PAGES </entry>
                            <entry>BIGINT </entry>
                            <entry>Количество страниц, выделенных для базы данных на внешнем
                                устройстве.</entry>
                        </row>
                        <row>
                            <entry>MON$STAT_ID </entry>
                            <entry>INTEGER </entry>
                            <entry>Идентификатор статистики.</entry>
                        </row>
                        <row>
                            <entry>MON$BACKUP_STATE </entry>
                            <entry>SMALLINT </entry>
                            <entry><para>Текущее физическое состояние backup: <itemizedlist
                                        spacing="compact">
                                        <listitem>
                                            <para>0 — нормальное;</para>
                                        </listitem>
                                        <listitem>
                                            <para>1 — заблокированное;</para>
                                        </listitem>
                                        <listitem>
                                            <para>2 — слияние (объединение).</para>
                                        </listitem>
                                    </itemizedlist></para>
                            </entry>
                        </row>
                        <row>
                            <entry>MON$CRYPT_PAGE</entry>
                            <entry>BIGINT </entry>
                            <entry>Количество зашифрованных страниц.</entry>
                        </row>
                        <row>
                            <entry>MON$OWNER</entry>
                            <entry>CHAR(63) </entry>
                            <entry>Владелец базы данных.</entry>
                        </row>
                        <row>
                            <entry>MON$SEC_DATABASE </entry>
                            <entry>CHAR(7)</entry>
                            <entry>
                                <para>Отображает, какой тип базы данных безопасности используется:
                                        <itemizedlist spacing="compact">
                                        <listitem>
                                            <para>Default — база данных безопасности по умолчанию,
                                                т.е. <filename>security4.fdb</filename>;</para>
                                        </listitem>
                                        <listitem>
                                            <para>Self — в качестве базы данных безопасности
                                                используется текущая база данных;</para>
                                        </listitem>
                                        <listitem>
                                            <para>Other — в качестве базы данных безопасности
                                                используется другая база данных (не сама и не
                                                  <filename>security4.fdb</filename>).</para>
                                        </listitem>
                                    </itemizedlist>
                                </para>
                            </entry>
                        </row>
                    </tbody>
                </tgroup>
            </table>
        </para>
    </section>

    <section xml:id="montables-io_stats">
        <info>
            <title>MON$IO_STATS</title>
            <keywordset>
                <keyword>MON$IO_STATS</keyword>
            </keywordset>
        </info>
        <indexterm><primary>MON$IO_STATS</primary></indexterm>
        <para>Статистика по вводу-выводу.</para>
        <para>
            <table xml:id="montables-tbl-io_stats" frame="all">
                <?dbfo keep-together='auto'?>
                <title>Описание столбцов таблицы MON$IO_STATS</title>
                <tgroup cols="3">
                    <colspec colname="colColumn" colnum="1" colwidth="4*" align="left"/>
                    <colspec colname="colType" colnum="2" colwidth="3*" align="left"/>
                    <colspec colname="colDesc" colnum="3" colwidth="5*" align="left"/>
                    <thead>
                        <row valign="middle">
                            <entry align="center">Наименование столбца</entry>
                            <entry align="center">Тип данных</entry>
                            <entry align="center">Описание</entry>
                        </row>
                    </thead>
                    <tbody>
                        <row>
                            <entry>MON$STAT_ID </entry>
                            <entry>INTEGER </entry>
                            <entry>Идентификатор статистики. </entry>
                        </row>
                        <row>
                            <entry>MON$STAT_GROUP </entry>
                            <entry>SMALLINT </entry>
                            <entry>
                                <para>Группа статистики: <itemizedlist spacing="compact">
                                        <listitem>
                                            <para>0 — база данных (database);</para>
                                        </listitem>
                                        <listitem>
                                            <para>1 — соединение с базой данных (connection);
                                            </para>
                                        </listitem>
                                        <listitem>
                                            <para>2 — транзакция (transaction);</para>
                                        </listitem>
                                        <listitem>
                                            <para>3 — оператор (statement);</para>
                                        </listitem>
                                        <listitem>
                                            <para>4 — вызов (call).</para>
                                        </listitem>
                                    </itemizedlist>
                                </para>
                            </entry>
                        </row>
                        <row>
                            <entry>MON$PAGE_READS </entry>
                            <entry>BIGINT </entry>
                            <entry>Количество прочитанных (read) страниц базы данных. </entry>
                        </row>
                        <row>
                            <entry>MON$PAGE_WRITES </entry>
                            <entry>BIGINT </entry>
                            <entry>Количество записанных (write) страниц базы данных. </entry>
                        </row>
                        <row>
                            <entry>MON$PAGE_FETCHES </entry>
                            <entry>BIGINT </entry>
                            <entry>Количество загруженных в память (fetch) страниц базы данных.
                            </entry>
                        </row>
                        <row>
                            <entry>MON$PAGE_MARKS </entry>
                            <entry>BIGINT </entry>
                            <entry>Количество отмеченных (mark) страниц базы данных. </entry>
                        </row>
                    </tbody>
                </tgroup>
            </table>
        </para>
        <para>Счётчики этой таблицы являются накопительными и накапливают информацию по каждой из
            групп статистики.</para>
    </section>
    <section xml:id="montables-memory_usage">
        <info>
            <title>MON$MEMORY_USAGE</title>
            <keywordset>
                <keyword>MON$MEMORY_USAGE</keyword>
            </keywordset>
        </info>
        <indexterm><primary>MON$MEMORY_USAGE</primary></indexterm>
        <para>Статистика использования памяти.</para>
        <para>
            <table xml:id="montables-tbl-memory_usage" frame="all">
                <?dbfo keep-together='auto'?>
                <title>Описание столбцов таблицы MON$MEMORY_USAGE</title>
                <tgroup cols="3">
                    <colspec colname="colColumn" colnum="1" colwidth="4*" align="left"/>
                    <colspec colname="colType" colnum="2" colwidth="3*" align="left"/>
                    <colspec colname="colDesc" colnum="3" colwidth="5*" align="left"/>
                    <thead>
                        <row valign="middle">
                            <entry align="center">Наименование столбца</entry>
                            <entry align="center">Тип данных</entry>
                            <entry align="center">Описание</entry>
                        </row>
                    </thead>
                    <tbody>
                        <row>
                            <entry>MON$STAT_ID </entry>
                            <entry>INTEGER </entry>
                            <entry>Идентификатор статистики. </entry>
                        </row>
                        <row>
                            <entry>MON$STAT_GROUP </entry>
                            <entry>SMALLINT </entry>
                            <entry><para>Группа статистики: <itemizedlist spacing="compact">
                                        <listitem>
                                            <para>0 — база данных (database);</para>
                                        </listitem>
                                        <listitem>
                                            <para>1 — соединение с базой данных (connection);
                                            </para>
                                        </listitem>
                                        <listitem>
                                            <para>2 — транзакция (transaction);</para>
                                        </listitem>
                                        <listitem>
                                            <para>3 — оператор (statement);</para>
                                        </listitem>
                                        <listitem>
                                            <para>4 — вызов (call).</para>
                                        </listitem>
                                    </itemizedlist></para>
                            </entry>
                        </row>
                        <row>
                            <entry>MON$MEMORY_USED </entry>
                            <entry>BIGINT </entry>
                            <entry>
                                <para>Количество используемой памяти, байт. Информация о
                                    высокоуровневом распределении памяти, выполненной сервером из
                                    пулов. Может быть полезна для отслеживания утечек памяти и
                                    чрезмерного потребления памяти в соединениях, процедурах и
                                    т.д.</para>
                            </entry>
                        </row>
                        <row>
                            <entry>MON$MEMORY_ALLOCATED </entry>
                            <entry>BIGINT </entry>
                            <entry>
                                <para>Количество памяти, выделенной ОС, байт. Информация о
                                    низкоуровневом распределении памяти, выполненном менеджером
                                    памяти Firebird — объем памяти, выделенный операционной
                                    системой, что позволяет контролировать физическое потребление
                                    памяти. Обратите внимание, не все записи этого столбца имеют
                                    ненулевые значения. Малые выделения памяти здесь не фиксируются,
                                    а вместо этого добавляются к пулу памяти базы данных. Только
                                    MON$DATABASE (MON$STAT_GROUP = 0) и связанные с выделением
                                    памяти объекты имеют ненулевое значение.</para>
                            </entry>
                        </row>
                        <row>
                            <entry>MON$MAX_MEMORY_USED </entry>
                            <entry>BIGINT </entry>
                            <entry>Максимальное количество байт, используемое данным
                                объектом.</entry>
                        </row>
                        <row>
                            <entry>MON$MAX_MEMORY_ALLOCATED </entry>
                            <entry>BIGINT </entry>
                            <entry>Максимальное количество байт, выделенное ОС данному
                                объекту.</entry>
                        </row>
                    </tbody>
                </tgroup>
            </table>
        </para>
        <note>
            <para> Счётчики, связанные с записями уровня базы данных MON$DATABASE (MON$STAT_GROUP =
                0), отображают выделение памяти для всех соединений. В архитектурах Classic и
                SuperClassic нулевые значения счётчиков обозначают, что в этих архитектурах нет
                общего кэша. </para>
        </note>

        <formalpara>
            <title>Примеры:</title>
            <para>
                <example>
                    <title>Получение 10 запросов потребляющих наибольшее количество памяти</title>
                    <para><programlisting language="sql">
SELECT STMT.MON$ATTACHMENT_ID, STMT.MON$SQL_TEXT, MEM.MON$MEMORY_USED
FROM MON$MEMORY_USAGE MEM
   NATURAL JOIN MON$STATEMENTS STMT
ORDER BY MEM.MON$MEMORY_USED DESC 
FETCH FIRST 10 ROWS ONLY
                </programlisting></para>
                </example>
            </para>
        </formalpara>
    </section>
    <section xml:id="montables-record_stats">
        <info>
            <title>MON$RECORD_STATS</title>
            <keywordset>
                <keyword>MON$RECORD_STATS</keyword>
            </keywordset>
        </info>
        <indexterm><primary>MON$RECORD_STATS</primary></indexterm>
        <para>Статистика на уровне записей.</para>
        <para>
            <table xml:id="montables-tbl-record_stats" frame="all">
                <?dbfo keep-together='auto'?>
                <title>Описание столбцов таблицы MON$RECORD_STATS</title>
                <tgroup cols="3">
                    <colspec colname="colColumn" colnum="1" colwidth="4*" align="left"/>
                    <colspec colname="colType" colnum="2" colwidth="3*" align="left"/>
                    <colspec colname="colDesc" colnum="3" colwidth="5*" align="left"/>
                    <thead>
                        <row valign="middle">
                            <entry align="center">Наименование столбца</entry>
                            <entry align="center">Тип данных</entry>
                            <entry align="center">Описание</entry>
                        </row>
                    </thead>
                    <tbody>
                        <row>
                            <entry>MON$STAT_ID </entry>
                            <entry>INTEGER </entry>
                            <entry>Идентификатор статистики. </entry>
                        </row>
                        <row>
                            <entry>MON$STAT_GROUP </entry>
                            <entry>SMALLINT </entry>
                            <entry>
                                <para>Группа статистики: <itemizedlist spacing="compact">
                                        <listitem>
                                            <para>0 — база данных (database);</para>
                                        </listitem>
                                        <listitem>
                                            <para>1 — соединение с базой данных (connection);
                                            </para>
                                        </listitem>
                                        <listitem>
                                            <para>2 — транзакция (transaction);</para>
                                        </listitem>
                                        <listitem>
                                            <para>3 — оператор (statement);</para>
                                        </listitem>
                                        <listitem>
                                            <para>4 — вызов (call).</para>
                                        </listitem>
                                    </itemizedlist></para>
                            </entry>
                        </row>
                        <row>
                            <entry>MON$RECORD_SEQ_READS </entry>
                            <entry>BIGINT </entry>
                            <entry>Количество последовательно считанных записей (read sequentially).
                            </entry>
                        </row>
                        <row>
                            <entry>MON$RECORD_IDX_READS </entry>
                            <entry>BIGINT </entry>
                            <entry>Количество записей, прочитанных при помощи индекса (read via an
                                index). </entry>
                        </row>
                        <row>
                            <entry>MON$RECORD_INSERTS </entry>
                            <entry>BIGINT </entry>
                            <entry>Количество добавленных записей (inserted records). </entry>
                        </row>
                        <row>
                            <entry>MON$RECORD_UPDATES </entry>
                            <entry>BIGINT </entry>
                            <entry>Количество изменённых записей (updated records). </entry>
                        </row>
                        <row>
                            <entry>MON$RECORD_DELETES </entry>
                            <entry>BIGINT </entry>
                            <entry>Количество удалённых записей (deleted records). </entry>
                        </row>
                        <row>
                            <entry>MON$RECORD_BACKOUTS </entry>
                            <entry>BIGINT </entry>
                            <entry>Количество возвращённых в базу данных записей (backed out
                                records). </entry>
                        </row>
                        <row>
                            <entry>MON$RECORD_PURGES </entry>
                            <entry>BIGINT </entry>
                            <entry>Количество удалённых ненужных записей (purged records). </entry>
                        </row>
                        <row>
                            <entry>MON$RECORD_EXPUNGES </entry>
                            <entry>BIGINT </entry>
                            <entry>Количество вычищенных средствами сборки мусора записей (expunged
                                records). </entry>
                        </row>
                        <row>
                            <entry>MON$RECORD_LOCKS </entry>
                            <entry>BIGINT </entry>
                            <entry>Количество записей прочитанных с использованием предложения WITH
                                LOCK. </entry>
                        </row>
                        <row>
                            <entry>MON$RECORD_WAITS </entry>
                            <entry>BIGINT </entry>
                            <entry>Количество попыток обновления/модификации/блокировки записей
                                принадлежащих нескольким активным транзакциям. Транзакция находится
                                в режиме WAIT.</entry>
                        </row>
                        <row>
                            <entry>MON$RECORD_CONFLICTS </entry>
                            <entry>BIGINT </entry>
                            <entry>Количество неудачных попыток обновления/модификации/блокировки
                                записей принадлежащих нескольким активным транзакциям. В таких
                                ситуациях сообщается о конфликте обновления (UPDATE
                                CONFLICT).</entry>
                        </row>
                        <row>
                            <entry>MON$BACKVERSION_READS </entry>
                            <entry>BIGINT </entry>
                            <entry>Количество прочитанных версий при поиске видимых версий
                                записей.</entry>
                        </row>
                        <row>
                            <entry>MON$FRAGMENT_READS </entry>
                            <entry>BIGINT </entry>
                            <entry>Количество прочитанных фрагментов записей. </entry>
                        </row>
                        <row>
                            <entry>MON$RECORD_RPT_READS </entry>
                            <entry>BIGINT </entry>
                            <entry>Количество повторно прочитанных записей. </entry>
                        </row>
                    </tbody>
                </tgroup>
            </table>
        </para>
        <para>Счётчики этой таблицы являются накопительными и накапливают информацию по каждой из
            групп статистики.</para>
    </section>

    <section xml:id="montables-statements">
        <info>
            <title>MON$STATEMENTS</title>
            <keywordset>
                <keyword>MON$STATEMENTS</keyword>
            </keywordset>
        </info>
        <indexterm><primary>MON$STATEMENTS</primary></indexterm>
        <para>Подготовленные к выполнению операторы.</para>
        <para>
            <table xml:id="montables-tbl-statements" frame="all">
                <?dbfo keep-together='auto'?>
                <title>Описание столбцов таблицы MON$STATEMENTS</title>
                <tgroup cols="3">
                    <colspec colname="colColumn" colnum="1" colwidth="4*" align="left"/>
                    <colspec colname="colType" colnum="2" colwidth="3*" align="left"/>
                    <colspec colname="colDesc" colnum="3" colwidth="5*" align="left"/>
                    <thead>
                        <row valign="middle">
                            <entry align="center">Наименование столбца</entry>
                            <entry align="center">Тип данных</entry>
                            <entry align="center">Описание</entry>
                        </row>
                    </thead>
                    <tbody>
                        <row>
                            <entry>MON$STATEMENT_ID </entry>
                            <entry>BIGINT </entry>
                            <entry>Идентификатор оператора. </entry>
                        </row>
                        <row>
                            <entry>MON$ATTACHMENT_ID </entry>
                            <entry>BIGINT </entry>
                            <entry>Идентификатор соединения. </entry>
                        </row>
                        <row>
                            <entry>MON$TRANSACTION_ID </entry>
                            <entry>BIGINT </entry>
                            <entry>Идентификатор транзакции. </entry>
                        </row>
                        <row>
                            <entry>MON$STATE </entry>
                            <entry>SMALLINT </entry>
                            <entry>
                                <para> Состояние оператора: <itemizedlist spacing="compact">
                                        <listitem>
                                            <para>0 — бездействующий (idle);</para>
                                        </listitem>
                                        <listitem>
                                            <para>1 — выполняемый (active); </para>
                                        </listitem>
                                        <listitem>
                                            <para>2 — приостановленный (stalled).</para>
                                        </listitem>
                                    </itemizedlist>
                                </para>
                            </entry>
                        </row>
                        <row>
                            <entry>MON$TIMESTAMP </entry>
                            <entry>TIMESTAMP </entry>
                            <entry>Дата и время старта оператора. </entry>
                        </row>
                        <row>
                            <entry>MON$SQL_TEXT </entry>
                            <entry>BLOB TEXT </entry>
                            <entry>Текст оператора на языке SQL. </entry>
                        </row>
                        <row>
                            <entry>MON$STAT_ID </entry>
                            <entry>INTEGER </entry>
                            <entry>Идентификатор статистики. </entry>
                        </row>
                        <row>
                            <entry>MON$EXPLAINED_PLAN </entry>
                            <entry>BLOB TEXT </entry>
                            <entry>План оператора в explain форме. </entry>
                        </row>
                        <row>
                            <entry>MON$STATEMENT_TIMEOUT</entry>
                            <entry>INTEGER</entry>
                            <entry>Тайм-аут SQL оператора уровня SQL оператора. Содержит значение
                                тайм-аута, установленное на уровне соединения/оператора, в
                                миллисекундах. Если тайм-аут не установлен — 0.</entry>
                        </row>
                        <row>
                            <entry>MON$STATEMENT_TIMER</entry>
                            <entry>TIMESTAMP</entry>
                            <entry>Время истечения таймера SQL оператора. Содержит NULL, если
                                тайм-аут SQL оператора не установлен, или если таймер не
                                запущен.</entry>
                        </row>
                    </tbody>
                </tgroup>
            </table>
        </para>
        <para>Состояние оператора STALLED — это состояние "приостановлено". Возможно для запроса,
            который начал своё выполнение, ещё не завершил его, но в данный момент не выполняется.
            Например, ждёт входных параметров или очередного фетча (fetch) от клиента.</para>

        <formalpara>
            <title>Примеры:</title>
            <para>
                <example>
                    <title>Отображение активных запросов за исключением тех, что выполняются в своём
                        соединении</title>
                    <para><programlisting language="sql">
SELECT ATT.MON$USER, ATT.MON$REMOTE_ADDRESS, STMT.MON$SQL_TEXT, STMT.MON$TIMESTAMP
FROM MON$ATTACHMENTS ATT
  JOIN MON$STATEMENTS STMT ON ATT.MON$ATTACHMENT_ID = STMT.MON$ATTACHMENT_ID
WHERE ATT.MON$ATTACHMENT_ID &lt;&gt; CURRENT_CONNECTION
  AND STMT.MON$STATE = 1
                </programlisting></para>
                </example>
            </para>
        </formalpara>

        <section xml:id="montables-statements-delete">
            <title>Использование MON$STATEMENTS для отмены запросов</title>

            <para>Таблицы мониторинга доступны только для чтения. Однако в сервер встроен механизм
                для удаления (и только удаления) записей в таблице MON$STATEMENTS, что позволяет
                завершить активный запрос.</para>
            <note>
                <para>
                    <itemizedlist spacing="compact">
                        <listitem>
                            <para>Попытка отмены запросов не выполняется, если в соединении в
                                настоящее время нет никаких выполняющихся операторов.</para>
                        </listitem>
                        <listitem>
                            <para>После отмены запроса вызов API-функций execute/fetch вернёт ошибку
                                с кодом isc_cancelled.</para>
                        </listitem>
                        <listitem>
                            <para>Последующие запросы в данном соединении не запрещёны.</para>
                        </listitem>
                        <listitem>
                            <para>Отмена запроса не происходит синхронно, оператор лишь помечает
                                запрос на отмену, а сама отмена производится ядром
                                асинхронно.</para>
                        </listitem>
                    </itemizedlist>
                </para>
            </note>

            <formalpara>
                <title>Примеры:</title>
                <para>
                    <example>
                        <title>Отмена всех активных запросов для заданного соединения</title>
                        <para><programlisting language="sql">
DELETE FROM MON$STATEMENTS
WHERE MON$ATTACHMENT_ID = 32
                </programlisting></para>
                    </example>
                </para>
            </formalpara>
        </section>
    </section>

    <section xml:id="montables-table_stats">
        <info>
            <title>MON$TABLE_STATS</title>
            <keywordset>
                <keyword>MON$TABLE_STATS</keyword>
            </keywordset>
        </info>
        <indexterm><primary>MON$TABLE_STATS</primary></indexterm>
        <para>Статистика на уровне таблицы.</para>
        <para>
            <table xml:id="montables-tbl-table_stats" frame="all">
                <title>Описание столбцов таблицы MON$TABLE_STATS</title>
                <tgroup cols="3">
                    <colspec colname="colColumn" colnum="1" colwidth="4*" align="left"/>
                    <colspec colname="colType" colnum="2" colwidth="3*" align="left"/>
                    <colspec colname="colDesc" colnum="3" colwidth="5*" align="left"/>
                    <thead>
                        <row valign="middle">
                            <entry align="center">Наименование столбца</entry>
                            <entry align="center">Тип данных</entry>
                            <entry align="center">Описание</entry>
                        </row>
                    </thead>
                    <tbody>
                        <row>
                            <entry>MON$STAT_ID </entry>
                            <entry>INTEGER </entry>
                            <entry>Идентификатор статистики. </entry>
                        </row>
                        <row>
                            <entry>MON$STAT_GROUP </entry>
                            <entry>SMALLINT </entry>
                            <entry>
                                <para>Группа статистики: <itemizedlist spacing="compact">
                                        <listitem>
                                            <para>0 — база данных (database);</para>
                                        </listitem>
                                        <listitem>
                                            <para>1 — соединение с базой данных (connection);
                                            </para>
                                        </listitem>
                                        <listitem>
                                            <para>2 — транзакция (transaction);</para>
                                        </listitem>
                                        <listitem>
                                            <para>3 — оператор (statement);</para>
                                        </listitem>
                                        <listitem>
                                            <para>4 — вызов (call).</para>
                                        </listitem>
                                    </itemizedlist></para>
                            </entry>
                        </row>
                        <row>
                            <entry>MON$TABLE_NAME </entry>
                            <entry>CHAR(63) </entry>
                            <entry>Имя таблицы. </entry>
                        </row>
                        <row>
                            <entry>MON$RECORD_STAT_ID </entry>
                            <entry>INTEGER </entry>
                            <entry>Ссылка на MON$RECORD_STATS. </entry>
                        </row>
                    </tbody>
                </tgroup>
            </table>
        </para>

        <formalpara>
            <title>Примеры:</title>
            <para>
                <example>
                    <title>Получение статистики на уровне записей по каждой таблицы для своего
                        соединения</title>
                    <para><programlisting language="sql">
SELECT
    t.mon$table_name,
    r.mon$record_inserts,
    r.mon$record_updates,
    r.mon$record_deletes,
    r.mon$record_backouts,
    r.mon$record_purges,
    r.mon$record_expunges,
    ------------------------
    r.mon$record_seq_reads,
    r.mon$record_idx_reads,
    r.mon$record_rpt_reads,
    r.mon$backversion_reads,
    r.mon$fragment_reads,
    ------------------------
    r.mon$record_locks,
    r.mon$record_waits,
    r.mon$record_conflicts,
    ------------------------
    a.mon$stat_id
FROM
    mon$record_stats r
    JOIN mon$table_stats t ON r.mon$stat_id = t.mon$record_stat_id
    JOIN mon$attachments a ON t.mon$stat_id = a.mon$stat_id
WHERE
      a.mon$attachment_id = CURRENT_CONNECTION   
                </programlisting></para>
                </example>
            </para>
        </formalpara>
    </section>
    <section xml:id="montables-transactions">
        <info>
            <title>MON$TRANSACTIONS</title>
            <keywordset>
                <keyword>MON$TRANSACTIONS</keyword>
            </keywordset>
        </info>
        <indexterm><primary>MON$TRANSACTIONS</primary></indexterm>
        <para>Описывает начатые транзакции</para>
        <para>
            <table xml:id="montables-tbl-transactions" frame="all">
                <?dbfo keep-together='auto'?>
                <title>Описание столбцов таблицы MON$TRANSACTIONS</title>
                <tgroup cols="3">
                    <colspec colname="colColumn" colnum="1" colwidth="4*" align="left"/>
                    <colspec colname="colType" colnum="2" colwidth="3*" align="left"/>
                    <colspec colname="colDesc" colnum="3" colwidth="5*" align="left"/>
                    <thead>
                        <row valign="middle">
                            <entry align="center">Наименование столбца</entry>
                            <entry align="center">Тип данных</entry>
                            <entry align="center">Описание</entry>
                        </row>
                    </thead>
                    <tbody>
                        <row>
                            <entry>MON$TRANSACTION_ID </entry>
                            <entry>BIGINT </entry>
                            <entry>Идентификатор (номер) транзакции. </entry>
                        </row>
                        <row>
                            <entry>MON$ATTACHMENT_ID </entry>
                            <entry>BIGINT </entry>
                            <entry>Идентификатор соединения. </entry>
                        </row>
                        <row>
                            <entry>MON$STATE </entry>
                            <entry>SMALLINT </entry>
                            <entry>
                                <para>Состояние транзакции: <itemizedlist spacing="compact">
                                        <listitem>
                                            <para>0 — бездействующая;</para>
                                        </listitem>
                                        <listitem>
                                            <para>1 — активная.</para>
                                        </listitem>
                                    </itemizedlist>
                                </para>
                            </entry>
                        </row>
                        <row>
                            <entry>MON$TIMESTAMP </entry>
                            <entry>TIMESTAMP </entry>
                            <entry>Дата и время старта транзакции. </entry>
                        </row>
                        <row>
                            <entry>MON$TOP_TRANSACTION </entry>
                            <entry>INTEGER </entry>
                            <entry>Идентификатор (номер) транзакции верхнего уровня. </entry>
                        </row>
                        <row>
                            <entry>MON$OLDEST_TRANSACTION </entry>
                            <entry>INTEGER </entry>
                            <entry>Номер старейшей заинтересованной транзакции — OIT, Oldest
                                Interesting Transaction. </entry>
                        </row>
                        <row>
                            <entry>MON$OLDEST_ACTIVE </entry>
                            <entry>INTEGER </entry>
                            <entry>Номер старейшей активной транзакции — OAT, Oldest Active
                                Transaction. </entry>
                        </row>
                        <row>
                            <entry>MON$ISOLATION_MODE </entry>
                            <entry>SMALLINT </entry>
                            <entry>
                                <para>Режим (уровень) изоляции: <itemizedlist spacing="compact">
                                        <listitem>
                                            <para>0 — consistency (snapshot table stability);</para>
                                        </listitem>
                                        <listitem>
                                            <para>1 — concurrency (snapshot);</para>
                                        </listitem>
                                        <listitem>
                                            <para>2 — read committed record version;</para>
                                        </listitem>
                                        <listitem>
                                            <para>3 — read committed no record version;</para>
                                        </listitem>
                                        <listitem>
                                            <para>4 — read committed read consistency.</para>
                                        </listitem>
                                    </itemizedlist>
                                </para>
                            </entry>
                        </row>
                        <row>
                            <entry>MON$LOCK_TIMEOUT </entry>
                            <entry>SMALLINT </entry>
                            <entry>
                                <para>Время ожидания: <itemizedlist spacing="compact">
                                        <listitem>
                                            <para>-1 — бесконечное ожидание (wait);</para>
                                        </listitem>
                                        <listitem>
                                            <para>0 — транзакция no wait;</para>
                                        </listitem>
                                        <listitem>
                                            <para>другое число — время ожидания в секундах (lock
                                                timeout).</para>
                                        </listitem>
                                    </itemizedlist>
                                </para>
                            </entry>
                        </row>
                        <row>
                            <entry>MON$READ_ONLY </entry>
                            <entry>SMALLINT </entry>
                            <entry>Признак, является ли транзакцией только для чтения, read only
                                (значение 1) или для чтения и записи, read-write (0). </entry>
                        </row>
                        <row>
                            <entry>MON$AUTO_COMMIT </entry>
                            <entry>SMALLINT </entry>
                            <entry>Признак, используется ли автоматическое подтверждение транзакции
                                auto-commit (значение 1) или нет (0). </entry>
                        </row>
                        <row>
                            <entry>MON$AUTO_UNDO </entry>
                            <entry>SMALLINT </entry>
                            <entry>Признак, используется ли автоматическая отмена транзакции
                                auto-undo (значение 1) или нет (0). </entry>
                        </row>
                        <row>
                            <entry>MON$STAT_ID </entry>
                            <entry>INTEGER </entry>
                            <entry>Идентификатор статистики. </entry>
                        </row>
                    </tbody>
                </tgroup>
            </table>
        </para>

        <formalpara>
            <title>Примеры:</title>
            <para>
                <example>
                    <title>Получение всех подключений, которые стартовали Read Write транзакции с
                        уровнем изоляции выше Read Commited.</title>
                    <para><programlisting language="sql">
SELECT
    DISTINCT a.*
FROM
    mon$attachments a
    JOIN mon$transactions t ON a.mon$attachment_id = t.mon$attachment_id
WHERE
  NOT(t.mon$read_only = 1 AND t.mon$isolation_mode >= 2);
                </programlisting></para>
                </example>
            </para>
        </formalpara>
    </section>
</appendix>
